window.onload=function(){function e(e){return(elem=document.getElementById(e)).parentNode.removeChild(elem)}function t(){N.fillStyle=b.color,N.fillRect(b.xStart,b.yStart,b.width,b.height)}function n(e){N.fillStyle=e.color,N.fillRect(e.x,e.y,e.width,e.height)}function o(e){for(var t=0;t<e.length;t++)n(e[t])}function i(){var e=B.x>=0||V>0,t=B.x<=T.width-B.width||0>V;return e&&t}function r(){var e=B.y>=0||Y>0,t=B.y<=T.height-B.height||0>Y;return t&&e}function d(e,t){return!(e.x+e.width<t.x||t.x+t.width<e.x||e.y+e.height<t.y||t.y+t.height<e.y)}function a(){F.play();for(var e=0;e<O.length;e++)0==O[e].y&&(O[e].y=140),O[e].y-=1}function c(e,t){for(var n=0;n<t.length;n++)if(d(e,t[n]))return!0}function h(){H.textContent="You've been destroyed!",P.remove(),T.remove(),q.appendChild(_),q.appendChild(U),Z.play(),F=0}function l(){return d(B,I)}function u(){P.textContent="",H.textContent="You destroyed the Death Star!",T.remove(),W.play(),q.appendChild(j),q.appendChild(U),j.play(),F=0}function w(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}function m(e){return z[e.keyCode]?(w(e),!1):void 0}function s(){window.addEventListener&&window.addEventListener("DOMMouseScroll",w,!1),document.onkeydown=m}function g(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",w,!1),document.onkeydown=null}function y(){s(),window.scrollTo(0,document.body.scrollHeight)}function f(){t(),i()&&(B.x+=V/60*Q),r()&&(B.y+=Y/60*Q),a(),o(G),N.drawImage(J,B.x,B.y,17,12),N.drawImage(X,75,145,10,5),N.drawImage(X,150,145,10,5),N.drawImage(X,225,145,10,5),N.drawImage(R,280,65,25,25),c(B,M)&&h(),l()&&u(),requestAnimationFrame(f)}var v={height:5,width:2,x:79,y:100,color:"#39ff14"},p={height:5,width:2,x:154,y:140,color:"#39ff14"},x={height:5,width:2,x:229,y:100,color:"#39ff14"},E={height:5,width:2,x:79,y:30,color:"#39ff14"},k={height:5,width:2,x:154,y:60,color:"#39ff14"},C={height:5,width:2,x:229,y:30,color:"#39ff14"},I={height:25,width:25,x:280,y:65,color:"#adff00"},b={xStart:0,yStart:0,height:150,width:300,color:"#000000"},S={height:5,width:10,x:75,y:145,color:"#000000"},L={height:5,width:10,x:150,y:145,color:"#000000"},A={height:5,width:10,x:225,y:145,color:"#000000"},B={height:10,width:15,x:10,y:10},D=0,M=[S,L,A,v,p,x,E,k,C],O=[v,p,x,E,k,C],F=new Audio("sounds/blaster-firing.mp3");F.loop=!1;var T=document.getElementById("spaceField"),q=document.getElementById("container"),N=T.getContext("2d"),R=new Image;R.src="images/death-star.png";var V=0,Y=0,j=document.createElement("VIDEO");j.src="video/death star explosion.mp4";var G=[B,I,S,L,A,v,p,x,E,k,C],H=document.getElementById("page-header"),P=document.getElementById("instructions"),U=document.createElement("BUTTON");U.textContent="Play Again";var z={37:1,38:1,39:1,40:1},J=new Image;J.src="images/ship.png";var K=[S,L,A],Q=100,W=new Audio("sounds/theme.mp3"),X=new Image;X.src="images/tie-fighter.png",W.loop=!1;var Z=new Audio("sounds/vaderbreathing.mp3");Z.loop=!0;var _=document.createElement("IMG");_.setAttribute("src","/images/vader.jpg"),T.addEventListener("click",y),U.addEventListener("click",window.location.reload.bind(window.location)),document.addEventListener("keydown",function(e){if(D!=e.keyCode)switch(D=e.keyCode,e.keyCode){case 37:V=-1;break;case 38:Y=-1;break;case 39:V=1;break;case 40:Y=1}}),document.addEventListener("keyup",function(e){switch(e.keyCode){case 37:case 39:V=0;break;case 38:case 40:Y=0}D=0}),requestAnimationFrame(f)};