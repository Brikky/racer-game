window.onload=function(){function e(e){return(elem=document.getElementById(e)).parentNode.removeChild(elem)}function t(){V.fillStyle=A.color,V.fillRect(A.xStart,A.yStart,A.width,A.height)}function n(e){V.fillStyle=e.color,V.fillRect(e.x,e.y,e.width,e.height)}function o(e){for(var t=0;t<e.length;t++)n(e[t])}function d(e){for(var t=0;t<e.length;t++)V.drawImage(e[t].name,e[t].x,e[t].y,e[t].width,e[t].height)}function r(){W=!W,W?G.push(F):G[G.length-1]==F&&G.pop()}function i(){V.drawImage(te,F.x,F.y,17,12)}function a(e){var t=e.x>=0||e.dx>0,n=e.x<=N.width-e.width||e.dx<0;return t&&n}function c(e){var t=e.y>=0||e.dy>0,n=e.y<=N.height-e.height||e.dy<0;return n&&t}function h(e,t){return!(e.x+e.width<t.x||t.x+t.width<e.x||e.y+e.height<t.y||t.y+t.height<e.y)}function l(){re=!re}function y(){re&&q.play();for(var e=0;e<P.length;e++)0==P[e].y&&(P[e].y=140),P[e].y-=1}function g(e,t){for(var n=0;n<t.length;n++)if(h(e,t[n]))return!0}function u(){U.textContent="You've been destroyed!",J.remove(),N.remove(),R.appendChild(he),R.appendChild(K),ce.play(),q=0}function s(){return h(O,B)||h(F,B)}function m(){J.textContent="",U.textContent="You destroyed the Death Star!",N.remove(),ie.play(),R.appendChild(j),R.appendChild(K),j.play(),q=0}function w(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}function f(e){return _[e.keyCode]?(w(e),!1):void 0}function x(){window.addEventListener&&window.addEventListener("DOMMouseScroll",w,!1),document.onkeydown=f}function v(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",w,!1),document.onkeydown=null}function p(){x(),window.scrollTo(0,document.body.scrollHeight)}function k(){t(),a(O)&&(O.x+=O.dx/60*oe),c(O)&&(O.y+=O.dy/60*oe),W&&(i(),a(F)&&(F.x+=F.dx/60*oe),c(F)&&(F.y+=F.dy/60*oe),h(O,F)&&u(),g(O,z)&&(J.innerHTML="<h4>Player one destroyed!</h4>",Q=!0,O.x=400,O.y=-100),g(F,z)&&(J.innerHTML="<h4>Player two destroyed!</h4>",Z=!0,F.x=2e3,F.y=-100),Q&&Z&&u()),y(),o(G),V.drawImage(ee,O.x,O.y,17,12),V.drawImage(ae,75,145,10,5),V.drawImage(ae,150,145,10,5),V.drawImage(ae,225,145,10,5),V.drawImage(Y,275,65,25,25),!W&&g(O,z)&&u(),s()&&m(),requestAnimationFrame(k)}var b={height:5,width:2,x:79,y:100,color:"#39ff14"},E={height:5,width:2,x:154,y:140,color:"#39ff14"},I={height:5,width:2,x:229,y:100,color:"#39ff14"},C={height:5,width:2,x:79,y:30,color:"#39ff14"},L={height:5,width:2,x:154,y:60,color:"#39ff14"},S={height:5,width:2,x:229,y:30,color:"#39ff14"},B={height:25,width:25,x:280,y:65,color:"rgba(0,0,0,0)"},A={xStart:0,yStart:0,height:150,width:300,color:"#000000"},M={height:5,width:10,x:75,y:145,color:"rgba(0,0,0,0)"},D={height:5,width:10,x:150,y:145,color:"rgba(0,0,0,0)"},T={height:5,width:10,x:225,y:145,color:"rgba(0,0,0,0)"},O={height:10,width:15,x:10,y:40,color:"rgba(0,0,0,0)",dx:0,dy:0},F={height:10,width:15,x:10,y:100,color:"rgba(0,0,0,0)",dx:0,dy:0},H=0,P=[b,E,I,C,L,S],q=new Audio("sounds/blaster-firing.mp3");q.loop=!1;var N=document.getElementById("spaceField"),R=document.getElementById("container"),V=N.getContext("2d"),Y=new Image;Y.src="images/death-star.png";var j=document.createElement("VIDEO");j.src="video/death star explosion.mp4";var G=[O,B,M,D,T,b,E,I,C,L,S],U=document.getElementById("page-header"),z=[M,D,T,b,E,I,C,L,S],J=document.getElementById("instructions"),K=document.createElement("BUTTON");K.textContent="Play Again";var Q=!1,W=!1,X=document.getElementById("player-toggle"),Z=!1,_={37:1,38:1,39:1,40:1,65:1,87:1,68:1,83:1},ee=new Image;ee.src="images/ship.png";var te=new Image;te.src="images/ship2.png";var ne=[M,D,T],oe=100,de=document.getElementById("sound-toggle"),re=!0,ie=new Audio("sounds/theme.mp3"),ae=new Image;ae.src="images/tie-fighter.png",ie.loop=!1;var ce=new Audio("sounds/vaderbreathing.mp3");ce.loop=!0;var he=document.createElement("IMG");he.setAttribute("src","/images/vader.jpg"),N.addEventListener("click",p),K.addEventListener("click",window.location.reload.bind(window.location)),de.addEventListener("click",l),X.addEventListener("click",r),document.addEventListener("keydown",function(e){if(H!=e.keyCode)switch(H=e.keyCode,e.keyCode){case 37:O.dx+=-1;break;case 38:O.dy+=-1;break;case 39:O.dx+=1;break;case 40:O.dy+=1;break;case 65:F.dx+=-1;break;case 87:F.dy+=-1;break;case 68:F.dx+=1;break;case 83:F.dy+=1}}),document.addEventListener("keyup",function(e){switch(e.keyCode){case 37:case 39:O.dx=0;break;case 38:case 40:O.dy=0;break;case 65:case 68:F.dx=0;break;case 87:case 83:F.dy=0}H=0}),requestAnimationFrame(k)};