window.onload=function(){function e(e){return(elem=document.getElementById(e)).parentNode.removeChild(elem)}function t(){V.fillStyle=H.color,V.fillRect(H.xStart,H.yStart,H.width,H.height)}function n(e){V.fillStyle=e.color,V.fillRect(e.x,e.y,e.width,e.height)}function o(e){for(var t=0;t<e.length;t++)n(e[t])}function d(e){for(var t=0;t<e.length;t++)V.drawImage(e[t].name,e[t].x,e[t].y,e[t].width,e[t].height)}function i(){X=!X,X?(G.push(P),J.appendChild(_)):G[G.length-1]==P&&(G.pop(),_.remove())}function r(){V.drawImage(oe,P.x,P.y,17,12)}function a(e){var t=e.x>=0||e.dx>0,n=e.x<=R.width-e.width||e.dx<0;return t&&n}function c(e){var t=e.y>=0||e.dy>0,n=e.y<=R.height-e.height||e.dy<0;return n&&t}function x(e,t){return!(e.x+e.width<t.x||t.x+t.width<e.x||e.y+e.height<t.y||t.y+t.height<e.y)}function h(){ae=!ae}function l(){ae&&N.play();for(var e=0;e<q.length;e++){if(q[e].y<=0)switch(q[e].y=140,e){case 0:case 3:q[e].x=E.x+E.width/2-1;break;case 1:case 4:q[e].x=I.x+I.width/2-1;break;case 2:case 5:q[e].x=C.x+C.width/2-1}O.x>=75||P.x>=75&&O.x<150&&P.x<150?q[e].y-=2:O.x>=150||P.x>=150?q[e].y-=3.5:q[e].y-=1}}function y(){O.x<75?O.x-E.x<=0?E.x-=.2:E.x+=.2:X&&P.x<75?P.x-E.x<=0?E.x-=.2:E.x+=.2:O.x>=75&&O.x<=150?O.x-I.x<=-10?I.x-=.35:I.x+=.35:X&&P.x>=75&&P.x<=150?P.x-I.x<=-10?I.x-=.35:I.x+=.35:O.x>150&&O.x<300?O.x-C.x<=-20?C.x-=.5:C.x+=.5:X&&P.x>150&&P.x<300&&(P.x-C.x<=-20?C.x-=.5:C.x+=.5)}function s(e,t){for(var n=0;n<t.length;n++)if(x(e,t[n]))return!0}function g(){W.textContent="You've been destroyed!",J.remove(),R.remove(),U.appendChild(le),U.appendChild(K),he.play(),N=0}function u(){return x(O,T)||x(P,T)}function w(){J.textContent="",W.textContent="You destroyed the Death Star!",R.remove(),ce.play(),U.appendChild(j),U.appendChild(K),j.play(),N=0}function m(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}function f(e){return te[e.keyCode]?(m(e),!1):void 0}function v(){window.addEventListener&&window.addEventListener("DOMMouseScroll",m,!1),document.onkeydown=f}function p(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",m,!1),document.onkeydown=null}function k(){v(),window.scrollTo(0,document.body.scrollHeight)}function b(){t(),a(O)&&(O.x+=O.dx/60*ie),c(O)&&(O.y+=O.dy/60*ie),X&&(r(),a(P)&&(P.x+=P.dx/60*ie),c(P)&&(P.y+=P.dy/60*ie),x(O,P)&&g(),s(O,z)&&(J.innerHTML="<h4>Player one destroyed!</h4>",Q=!0,O.x=400,O.y=-100),s(P,z)&&(J.innerHTML="<h4>Player two destroyed!</h4>",ee=!0,P.x=2e3,P.y=-100),Q&&ee&&g()),l(),y(),o(G),V.drawImage(ne,O.x,O.y,17,12),V.drawImage(xe,E.x,145,10,5),V.drawImage(xe,I.x,145,10,5),V.drawImage(xe,C.x,145,10,5),V.drawImage(Y,275,65,25,25),!X&&s(O,z)&&g(),u()&&w(),requestAnimationFrame(b)}var E={height:5,width:10,x:75,y:145,color:"rgba(0,0,0,0)"},I={height:5,width:10,x:150,y:145,color:"rgba(0,0,0,0)"},C={height:5,width:10,x:225,y:145,color:"rgba(0,0,0,0)"},L={height:5,width:2,x:E.x+E.width/2-1,y:100,color:"#39ff14"},S={height:5,width:2,x:I.x+I.width/2-1,y:140,color:"#39ff14"},B={height:5,width:2,x:C.x+C.width/2-1,y:100,color:"#39ff14"},A={height:5,width:2,x:E.x+E.width/2-1,y:30,color:"#39ff14"},D={height:5,width:2,x:I.x+I.width/2-1,y:60,color:"#39ff14"},M={height:5,width:2,x:C.x+C.width/2-1,y:30,color:"#39ff14"},T={height:25,width:25,x:280,y:65,color:"rgba(0,0,0,0)"},H={xStart:0,yStart:0,height:150,width:300,color:"#000000"},O={height:10,width:15,x:10,y:40,color:"rgba(0,0,0,0)",dx:0,dy:0},P={height:10,width:15,x:10,y:100,color:"rgba(0,0,0,0)",dx:0,dy:0},F=0,q=[L,S,B,A,D,M],N=new Audio("sounds/blaster-firing.mp3");N.loop=!1;var R=document.getElementById("spaceField"),U=document.getElementById("container"),V=R.getContext("2d"),Y=new Image;Y.src="images/death-star.png";var j=document.createElement("VIDEO");j.src="video/death star explosion.mp4";var G=[O,T,E,I,C,L,S,B,A,D,M],W=document.getElementById("page-header"),z=[E,I,C,L,S,B,A,D,M],J=document.getElementById("instructions"),K=document.createElement("BUTTON");K.textContent="Play Again";var Q=!1,X=!1,Z=document.getElementById("player-toggle"),_=document.createElement("H4");_.textContent="Player 2 Use WASD as arrow keys.";var ee=!1,te={37:1,38:1,39:1,40:1,65:1,87:1,68:1,83:1},ne=new Image;ne.src="images/ship.png";var oe=new Image;oe.src="images/ship2.png";var de=[E,I,C],ie=100,re=document.getElementById("sound-toggle"),ae=!0,ce=new Audio("sounds/theme.mp3"),xe=new Image;xe.src="images/tie-fighter.png",ce.loop=!1;var he=new Audio("sounds/vaderbreathing.mp3");he.loop=!0;var le=document.createElement("IMG");le.src="images/vader.jpg",R.addEventListener("click",k),K.addEventListener("click",window.location.reload.bind(window.location)),re.addEventListener("click",h),Z.addEventListener("click",i),document.addEventListener("keydown",function(e){if(F!=e.keyCode)switch(F=e.keyCode,e.keyCode){case 37:O.dx+=-1;break;case 38:O.dy+=-1;break;case 39:O.dx+=1;break;case 40:O.dy+=1;break;case 65:P.dx+=-1;break;case 87:P.dy+=-1;break;case 68:P.dx+=1;break;case 83:P.dy+=1}}),document.addEventListener("keyup",function(e){switch(e.keyCode){case 37:case 39:O.dx=0;break;case 38:case 40:O.dy=0;break;case 65:case 68:P.dx=0;break;case 87:case 83:P.dy=0}F=0}),requestAnimationFrame(b)};