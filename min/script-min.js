window.onload=function(){function e(e){return(elem=document.getElementById(e)).parentNode.removeChild(elem)}function t(){V.fillStyle=S.color,V.fillRect(S.xStart,S.yStart,S.width,S.height)}function n(e){V.fillStyle=e.color,V.fillRect(e.x,e.y,e.width,e.height)}function o(e){for(var t=0;t<e.length;t++)n(e[t])}function i(e){for(var t=0;t<e.length;t++)V.drawImage(e[t].name,e[t].x,e[t].y,e[t].width,e[t].height)}function d(){var e=M.x>=0||j>0,t=M.x<=N.width-M.width||0>j;return e&&t}function r(){var e=M.y>=0||G>0,t=M.y<=N.height-M.height||0>G;return t&&e}function a(e,t){return!(e.x+e.width<t.x||t.x+t.width<e.x||e.y+e.height<t.y||t.y+t.height<e.y)}function c(){_=!_}function h(){_&&q.play();for(var e=0;e<T.length;e++)0==T[e].y&&(T[e].y=140),T[e].y-=1}function l(e,t){for(var n=0;n<t.length;n++)if(a(e,t[n]))return!0}function u(){U.textContent="You've been destroyed!",z.remove(),N.remove(),R.appendChild(oe),R.appendChild(J),ne.play(),q=0}function g(){return a(M,L)}function m(){z.textContent="",U.textContent="You destroyed the Death Star!",N.remove(),ee.play(),R.appendChild(H),R.appendChild(J),H.play(),q=0}function w(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}function s(e){return K[e.keyCode]?(w(e),!1):void 0}function f(){window.addEventListener&&window.addEventListener("DOMMouseScroll",w,!1),document.onkeydown=s}function y(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",w,!1),document.onkeydown=null}function v(){f(),window.scrollTo(0,document.body.scrollHeight)}function p(){t(),d()&&(M.x+=j/60*X),r()&&(M.y+=G/60*X),h(),o(P),V.drawImage(Q,M.x,M.y,17,12),V.drawImage(te,75,145,10,5),V.drawImage(te,150,145,10,5),V.drawImage(te,225,145,10,5),V.drawImage(Y,275,65,25,25),l(M,F)&&u(),g()&&m(),requestAnimationFrame(p)}var x={height:5,width:2,x:79,y:100,color:"#39ff14"},E={height:5,width:2,x:154,y:140,color:"#39ff14"},I={height:5,width:2,x:229,y:100,color:"#39ff14"},k={height:5,width:2,x:79,y:30,color:"#39ff14"},C={height:5,width:2,x:154,y:60,color:"#39ff14"},b={height:5,width:2,x:229,y:30,color:"#39ff14"},L={height:25,width:25,x:280,y:65,color:"#adff00"},S={xStart:0,yStart:0,height:150,width:300,color:"#000000"},A={height:5,width:10,x:75,y:145,color:"#000000"},B={height:5,width:10,x:150,y:145,color:"#000000"},D={height:5,width:10,x:225,y:145,color:"#000000"},M={height:10,width:15,x:10,y:10},O=0,F=[A,B,D,x,E,I,k,C,b],T=[x,E,I,k,C,b],q=new Audio("sounds/blaster-firing.mp3");q.loop=!1;var N=document.getElementById("spaceField"),R=document.getElementById("container"),V=N.getContext("2d"),Y=new Image;Y.src="images/death-star.png";var j=0,G=0,H=document.createElement("VIDEO");H.src="video/death star explosion.mp4";var P=[M,L,A,B,D,x,E,I,k,C,b],U=document.getElementById("page-header"),z=document.getElementById("instructions"),J=document.createElement("BUTTON");J.textContent="Play Again";var K={37:1,38:1,39:1,40:1},Q=new Image;Q.src="images/ship.png";var W=[A,B,D],X=100,Z=document.getElementById("sound-toggle"),_=!0,ee=new Audio("sounds/theme.mp3"),te=new Image;te.src="images/tie-fighter.png",ee.loop=!1;var ne=new Audio("sounds/vaderbreathing.mp3");ne.loop=!0;var oe=document.createElement("IMG");oe.setAttribute("src","/images/vader.jpg"),N.addEventListener("click",v),J.addEventListener("click",window.location.reload.bind(window.location)),Z.addEventListener("click",c),document.addEventListener("keydown",function(e){if(O!=e.keyCode)switch(O=e.keyCode,e.keyCode){case 37:j=-1;break;case 38:G=-1;break;case 39:j=1;break;case 40:G=1}}),document.addEventListener("keyup",function(e){switch(e.keyCode){case 37:case 39:j=0;break;case 38:case 40:G=0}O=0}),requestAnimationFrame(p)};